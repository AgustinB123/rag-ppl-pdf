CrearDialogo
    NrOperacion1: 'Operacion';;;;;;;;;;;;;;"Especie='USD'"
FinDialogo

SQL.ADD("SELECT Cliente1, Cliente2, Precio1, ConceptoBcra, TotalBrutoCli1, FechaOp, Plazo, Cantidad FROM " ~ DBO ~ ".OPERACIONES WHERE NrOperacion='" ~ Dialogo.NrOperacion1 ~ "'")
recorrer SQL    
     acd(z1, FBN['FechaOp'])
     
     * fecha_larga
     ACT(a1, FStr(Dia(val(z1)),0,0)~' de '~Meses(Mes(val(z1)))~' de '~FStr(Anio(val(z1)),0,0))
    
     * razon_social
     ACT(b1, BuscarCampo('CLIENTES','RazonSocial','Codigo',FBN['Cliente1']))
     
     * fecha_corta
     ACD(c1, Fecha(FBN['FechaOp']))
     
     * cantidad
     ACT(d1, pyc(FBN['Cantidad'],1,2))     
     
     * cantidad_textual (i.e. DIEZ MIL)
     ACT(e1, Letras(FBN['Cantidad']))
     
     * tipo_de_cambio
     ACT(f1, FStr(FBN['Precio1'], 0, 9))
     
     * codigo
     ACT(g1, FStr(103, 0, 0))
     
     * concepto
     ACT(h1, ' DEL EXTERIOR')
    
     * razon_social_tomado
     ACT(i1, BuscarCampo('CLIENTES','RazonSocial','Codigo',FBN['Cliente2']))
     
     * plazo
     ACT(j1, FStr(FBN['Plazo']))
     
     * razon_social_up
     ACT(k1, Mayusculas(BuscarCampo('CLIENTES','RazonSocial','Codigo',FBN['Cliente1'])))
     
     * importe
     ACT(l1, pyc(FBN['TotalBrutoCli1'],1,2))
     break    
proximo
 
Emitircarta("C:\test\template_carta.dotx","C:\test\carta.docx", fecha_larga=Val(a1), razon_social=Val(b1), fecha_corta=val(c1), cantidad=val(d1), cantidad_textual=val(e1), tipo_de_cambio=val(f1), codigo=Val(g1), concepto=val(h1), razon_social_tomado=val(i1), plazo=val(j1), razon_social_up=val(k1), importe=val(l1))
MessageBox ('La carta fue generada correctamente.')